# Enable Rewrite Engine
RewriteEngine On

# Ensure that the request is not for an existing file or directory
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Redirect root URL to the index page
RewriteRule ^$ app/page/index.php [L]

# Clean URLs: rewrite /something (or /something/) to app/page/something.php
RewriteRule ^([-a-z0-9_]+)/?$ app/page/$1.php [L,QSA,NC]

# Block direct access to layout files
RewriteRule ^app/layout/ - [F,L]

# Prevent direct access to .htaccess
<Files .htaccess>
    Require all denied
</Files>

# Custom 404 error page
ErrorDocument 404 /app/page/404.php

# Block access to sensitive files
<FilesMatch "\.(env|git|htpasswd|ini|log|bak)$">
    Require all denied
</FilesMatch>

# Set default index page
DirectoryIndex app/page/index.php

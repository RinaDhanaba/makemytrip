# Enable Rewrite Engine
RewriteEngine On

# Ensure the request is not for an existing file or directory
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

# Ensure the request to the root URL (/) points to app/page/index.php
RewriteCond %{REQUEST_URI} ^/$
RewriteRule ^$ app/page/index.php [L]

# Dynamic Rewrite for Nested Folders Inside /page/ (ðŸ”¥ FINAL WORKING)
RewriteRule ^(.+)/(.+)$ app/page/$1/$2.php [L,QSA]

# Clean URLs for Main Pages
RewriteRule ^([a-zA-Z0-9_-]+)$ app/page/$1.php [L,QSA]

# Block direct access to layout files
RewriteCond %{REQUEST_URI} ^/app/layout/.*$
RewriteRule ^.*$ - [F,L]

# Prevent direct access to .htaccess itself
<Files .htaccess>
    Require all denied
</Files>

# Custom 404 Page
ErrorDocument 404 /app/page/404.php

# Block sensitive files
<FilesMatch "\.(env|git|htpasswd|ini|log|bak)$">
    Require all denied
</FilesMatch>

# Default Index
DirectoryIndex app/page/index.php
